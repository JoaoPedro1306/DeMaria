-- USER (USR)
CREATE TABLE TBL_USER(
	USR_ID SERIAL,
	USR_NAME VARCHAR(100) NOT NULL,
	USR_EMAIL VARCHAR(100) NOT NULL,
	USR_PASSWORD VARCHAR(255),
	CREATION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	CREATED_BY INT NOT NULL,
	MODIFIED_DATE TIMESTAMP,
	MODIFIED_BY INT,
	PRIMARY KEY (USR_ID),
	FOREIGN KEY (CREATED_BY) REFERENCES TBL_USER (USR_ID),
	FOREIGN KEY (MODIFIED_BY) REFERENCES TBL_USER (USR_ID),
	UNIQUE (USR_EMAIL)
);

-- CUSTOMER (CST)
CREATE TABLE TBL_CUSTOMER(
	CST_ID SERIAL,
	CST_NAME VARCHAR(100) NOT NULL,
	CST_CPF VARCHAR(11) NOT NULL,
	CST_EMAIL VARCHAR(100) NOT NULL,
	CST_PHONE VARCHAR(11), NOT NULL,
	CREATION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	CREATED_BY INT NOT NULL,
	MODIFIED_DATE TIMESTAMP,
	MODIFIED_BY INT,
	PRIMARY KEY (CST_ID),
	FOREIGN KEY (CREATED_BY) REFERENCES TBL_USER (USR_ID),
	FOREIGN KEY (MODIFIED_BY) REFERENCES TBL_USER (USR_ID),
	UNIQUE (CST_CPF),
	UNIQUE (CST_EMAIL),
	UNIQUE (CST_PHONE)

);

-- ADDRESS (ADR)
CREATE TABLE TBL_ADDRESS(
	CST_ID INT NOT NULL,
	ADR_ZIP_CODE VARCHAR(7) NOT NULL,
	ADR_STREET VARCHAR(100) NOT NULL,
	ADR_NUMBER INT NOT NULL,
	ADR_COMPLEMENT VARCHAR(100),
	ADR_CITY VARCHAR(100) NOT NULL,
	ADR_STATE VARCHAR(100) NOT NULL,
	CREATION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	CREATED_BY INT NOT NULL,
	MODIFIED_DATE TIMESTAMP,
	MODIFIED_BY INT,
	PRIMARY KEY (CST_ID),
	FOREIGN KEY (CST_ID) REFERENCES TBL_CUSTOMER,
	FOREIGN KEY (CREATED_BY) REFERENCES TBL_USER (USR_ID),
	FOREIGN KEY (MODIFIED_BY) REFERENCES TBL_USER (USR_ID)
);

-- PRODUCT (PRD)
CREATE TABLE TBL_PRODUCT (
	PRD_ID SERIAL,
	PRD_NAME VARCHAR(100) NOT NULL,
	PRD_PRICE DECIMAL(10, 2) NOT NULL,
	PRD_STOCK INT NOT NULL,
	CREATION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	CREATED_BY INT NOT NULL,
	MODIFIED_DATE TIMESTAMP,
	MODIFIED_BY INT,
	PRIMARY KEY (PRD_ID),
	FOREIGN KEY (CREATED_BY) REFERENCES TBL_USER (USR_ID),
	FOREIGN KEY (MODIFIED_BY) REFERENCES TBL_USER (USR_ID)
);


-- SALES (SLS)
CREATE TABLE TBL_SALES (
	SLS_ID SERIAL,
	CST_ID INT NOT NULL, 
	CREATION_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
	CREATED_BY INT NOT NULL,
	MODIFIED_DATE TIMESTAMP,
	MODIFIED_BY INT,
	PRIMARY KEY (SLS_ID),
	FOREIGN KEY (CST_ID) REFERENCES TBL_CUSTOMER (CST_ID),
	FOREIGN KEY (CREATED_BY) REFERENCES TBL_USER (USR_ID),
	FOREIGN KEY (MODIFIED_BY) REFERENCES TBL_USER (USR_ID)
);

-- PRODUCT_SALE
CREATE TABLE TBL_PRODUCT_SALE (
	SLS_ID INT NOT NULL,
	PRD_ID INT NOT NULL,
	PRS_QUANTITY INT NOT NULL,
	PRIMARY KEY (SLS_ID, PRD_ID),
	FOREIGN KEY (SLS_ID) REFERENCES TBL_SALES (SLS_ID),
	FOREIGN KEY (PRD_ID) REFERENCES TBL_PRODUCT (PRD_ID)
);